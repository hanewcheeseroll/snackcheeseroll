<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cheeseroll Hanew — Toko</title>
  <style>
    :root{--gold1:#FFD54A;--gold2:#FFB300;--bg:#fffaf3;--accent:#3b2f0b;--muted:#6b6460}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; margin:0;background:var(--bg);color:var(--accent)}
    header{display:flex;align-items:center;justify-content:space-between;padding:14px 22px;background:linear-gradient(90deg,#fff8e6, #fff);border-bottom:1px solid rgba(0,0,0,0.03)}
    .logo{width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--gold1),var(--gold2));display:flex;align-items:center;justify-content:center;font-weight:900}
    nav a{margin-left:12px;text-decoration:none;color:var(--accent);font-weight:700}
    .container{max-width:1100px;margin:22px auto;padding:0 18px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}
    .card{background:#fff;padding:14px;border-radius:14px;box-shadow:0 8px 24px rgba(43,31,0,0.04);display:flex;flex-direction:column;gap:10px;border:1px solid rgba(0,0,0,0.03)}
    .thumb{height:160px;border-radius:10px;background:linear-gradient(180deg,#fff,#fff7e6);display:flex;align-items:center;justify-content:center;font-weight:800;color:var(--muted)}
    .price{font-weight:900;color:var(--gold2)}
    .actions{display:flex;gap:8px;margin-top:auto}
    .btn{padding:10px 12px;border-radius:10px;font-weight:800;border:0;cursor:pointer}
    .btn.add{background:var(--gold2);color:#2b1f00}
    .btn.shopee{background:#ee4d2d;color:#fff}
    .cartbar{position:fixed;right:18px;bottom:18px;background:linear-gradient(90deg,#fff,#fff7e6);padding:12px;border-radius:12px;box-shadow:0 12px 30px rgba(43,31,0,0.12);border:1px solid rgba(0,0,0,0.04)}
    .cart-count{background:#ef4444;color:#fff;border-radius:999px;padding:4px 8px;font-weight:800;margin-left:8px}
    .modal{position:fixed;left:0;top:0;width:100%;height:100%;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.35)}
    .modal .box{background:#fff;padding:18px;border-radius:12px;max-width:720px;width:92%}
    @media(max-width:680px){.grid{grid-template-columns:repeat(auto-fill,minmax(180px,1fr))}}
  </style>
</head>
<body>
  <header>
    <div style="display:flex;align-items:center;gap:12px">
      <div class="logo">H</div>
      <div>
        <div style="font-weight:900">Cheeseroll Hanew</div>
        <div style="font-size:12px;color:var(--muted)">Toko resmi</div>
      </div>
    </div>
    <nav>
      <a href="index.hanew">Beranda</a>
      <a href="shop.hanew">Toko</a>
    </nav>
  </header>

  <main class="container">
    <h2 style="margin:14px 0 6px">Produk</h2>
    <p style="color:var(--muted);margin:0 0 18px">Pilih produk, tambahkan ke keranjang, lalu lanjut ke Shopee untuk pembayaran aman dan pengiriman.</p>

    <div class="grid" id="productGrid">
      <!-- product: id, name, price, shopee keyword -->
      <template id="tplProduct">
        <div class="card">
          <div class="thumb">Gambar</div>
          <div>
            <strong class="p-name"></strong>
            <div style="color:var(--muted);font-size:13px" class="p-desc"></div>
          </div>
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="price p-price"></div>
            <div style="color:var(--muted);font-size:12px">Stok: <span class="p-stock">-</span></div>
          </div>
          <div class="actions">
            <button class="btn add">Tambah</button>
            <button class="btn shopee">Beli di Shopee</button>
          </div>
        </div>
      </template>
    </div>
  </main>

  <div class="cartbar" id="cartbar">
    <div style="display:flex;align-items:center;gap:8px">
      <div style="font-weight:900">Keranjang</div>
      <div class="cart-count" id="cartCount">0</div>
    </div>
    <div style="margin-top:8px;display:flex;gap:8px">
      <button class="btn" id="viewCart" style="background:transparent;border:1px solid rgba(0,0,0,0.06)">Lihat</button>
      <button class="btn" id="checkoutShopee" style="background:var(--gold2)">Checkout ke Shopee</button>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="box">
      <h3>Keranjang Anda</h3>
      <div id="cartList" style="margin:12px 0"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn" id="closeModal" style="background:transparent;border:1px solid rgba(0,0,0,0.06)">Tutup</button>
        <button class="btn" id="checkoutShopeeModal" style="background:var(--gold2)">Checkout ke Shopee</button>
        <button class="btn" id="orderWhatsApp" style="background:#25D366;color:#fff">Pesan via WA</button>
      </div>
    </div>
  </div>

  <script>
    // Produk contoh
    const products = [
      {id:'classic', name:'Cheeseroll Classic', price:15000, desc:'Keju cheddar lumer', stock:120},
      {id:'spicy', name:'Cheeseroll Spicy', price:17000, desc:'Sentuhan pedas menggoda', stock:80},
      {id:'seaweed', name:'Cheeseroll Seaweed', price:16000, desc:'Aroma rumput laut', stock:60},
      {id:'bbq', name:'Cheeseroll BBQ', price:18000, desc:'Rasa smoky manis', stock:40}
    ];

    const cartKey = 'hanew_cart_v2';
    const tpl = document.getElementById('tplProduct').content;
    const grid = document.getElementById('productGrid');

    function formatRupiah(n){ return 'Rp ' + n.toLocaleString('id-ID'); }

    // render produk
    products.forEach(p=>{
      const el = document.importNode(tpl,true);
      el.querySelector('.p-name').textContent = p.name;
      el.querySelector('.p-desc').textContent = p.desc;
      el.querySelector('.p-price').textContent = formatRupiah(p.price);
      el.querySelector('.p-stock').textContent = p.stock;
      // thumb placeholder
      el.querySelector('.thumb').textContent = p.name.split(' ')[1] || 'Gbr';
      const card = el.querySelector('.card');
      card.dataset.id = p.id;
      card.dataset.name = p.name;
      card.dataset.price = p.price;
      grid.appendChild(el);
    });

    // cart helpers
    function loadCart(){ try{ return JSON.parse(sessionStorage.getItem(cartKey)) || {}; }catch(e){return {}} }
    function saveCart(c){ sessionStorage.setItem(cartKey, JSON.stringify(c)); updateCartBadge(); }
    function updateCartBadge(){
      const c = loadCart();
      const total = Object.values(c).reduce((s,i)=>s+i.qty,0);
      document.getElementById('cartCount').textContent = total;
    }

    // tombol add & shopee per produk
    document.addEventListener('click', e=>{
      if(e.target.matches('.card .add') || e.target.matches('.card .add *')){
        const btn = e.target.closest('.add') || e.target;
        const card = btn.closest('.card');
        const id = card.dataset.id;
        const name = card.dataset.name;
        const price = Number(card.dataset.price);
        const cart = loadCart();
        if(!cart[id]) cart[id] = {id,name,price,qty:0};
        cart[id].qty += 1;
        saveCart(cart);
        btn.textContent = '✓';
        setTimeout(()=>btn.textContent='Tambah',900);
      }

      if(e.target.matches('.card .shopee') || e.target.matches('.card .shopee *')){
        const card = e.target.closest('.card');
        const name = card.dataset.name;
        // buka pencarian Shopee untuk produk spesifik
        const url = 'https://shopee.co.id/search?keyword=' + encodeURIComponent(name);
        window.open(url, '_blank');
      }
    });

    // tampilan modal keranjang
    const modal = document.getElementById('modal');
    document.getElementById('viewCart').addEventListener('click', ()=>{
      renderCartList();
      modal.style.display = 'flex';
    });
    document.getElementById('closeModal').addEventListener('click', ()=> modal.style.display='none');
    window.addEventListener('click', e=>{ if(e.target===modal) modal.style.display='none' });

    function renderCartList(){
      const c = loadCart();
      const list = document.getElementById('cartList');
      list.innerHTML = '';
      if(Object.keys(c).length===0){ list.innerHTML = '<div style="color:var(--muted)">Keranjang kosong</div>'; return; }
      Object.values(c).forEach(item=>{
        const row = document.createElement('div');
        row.style.display='flex'; row.style.justifyContent='space-between'; row.style.alignItems='center'; row.style.gap='8px'; row.style.marginBottom='8px';
        row.innerHTML = `<div><strong>${item.name}</strong><div style="font-size:13px;color:var(--muted)">${item.qty} x ${formatRupiah(item.price)}</div></div>
          <div style="display:flex;gap:8px;align-items:center">
            <button data-id="${item.id}" class="btn dec" style="background:#eee">-</button>
            <div style="min-width:28px;text-align:center">${item.qty}</div>
            <button data-id="${item.id}" class="btn inc" style="background:#eee">+</button>
            <button data-id="${item.id}" class="btn" style="background:#ff6b6b;color:#fff">Hapus</button>
          </div>`;
        list.appendChild(row);
      });
    }

    // inc/dec/hapus di modal
    document.getElementById('cartList').addEventListener('click', e=>{
      if(e.target.matches('.inc')||e.target.matches('.dec')||e.target.matches('.btn[data-id]')){
        const id = e.target.dataset.id;
        const cart = loadCart();
        if(!cart[id]) return;
        if(e.target.classList.contains('inc')) cart[id].qty += 1;
        else if(e.target.classList.contains('dec')){ cart[id].qty = Math.max(1, cart[id].qty-1); }
        else { delete cart[id]; }
        saveCart(cart);
        renderCartList();
      }
    });

    // checkout ke Shopee: buka search gabungan (Shopee tidak mendukung add-to-cart via URL umum)
    function checkoutShopeeFromCart(){
      const c = loadCart();
      if(Object.keys(c).length===0){ alert('Keranjang kosong'); return; }
      const keywords = Object.values(c).map(i=>i.name).join(' ');
      const url = 'https://shopee.co.id/search?keyword=' + encodeURIComponent(keywords);
      window.open(url, '_blank');
    }

    document.getElementById('checkoutShopee').addEventListener('click', checkoutShopeeFromCart);
    document.getElementById('checkoutShopeeModal').addEventListener('click', checkoutShopeeFromCart);

    // order via WhatsApp with ringkasan
    document.getElementById('orderWhatsApp').addEventListener('click', ()=>{
      const c = loadCart();
      if(Object.keys(c).length===0){ alert('Keranjang kosong'); return; }
      const lines = Object.values(c).map(i=>`- ${i.name} x${i.qty}`);
      const text = encodeURIComponent('Halo, saya ingin memesan:\n' + lines.join('\n') + '\n\nTerima kasih.');
      const phone = '6281234567890';
      window.open('https://wa.me/' + phone + '?text=' + text, '_blank');
    });

    // inisialisasi
    updateCartBadge();
  </script>
</body>
</html>